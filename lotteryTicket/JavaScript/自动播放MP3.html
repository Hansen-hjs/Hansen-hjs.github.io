<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <title></title>
  </head>
  <body>
      <audio src="" autoplay preload controls style="visibility: hidden" id="bgmusic"></audio>
  </body>
</html>
<script type="text/javascript">
window.onload = () => {
    //     alert('网页完成加载')
    var audioEl = document.getElementById('bgmusic');
    var log = info => console.log(info);
    var forceSafariPlayAudio = () => {
        audioEl.load(); // iOS 9   还需要额外的 load 一下, 否则直接 play 无效
        audioEl.play(); // iOS 7/8 仅需要 play 一下
    }
    // 可以自动播放时正确的事件顺序是
    // loadstart
    // loadedmetadata
    // loadeddata
    // canplay
    // play
    // playing
    // 不能自动播放时触发的事件是
    // iPhone5  iOS 7.0.6 loadstart
    // iPhone6s iOS 9.1   loadstart -> loadedmetadata -> loadeddata -> canplay
    audioEl.addEventListener('loadstart', () => {
        log('loadstart');
    }, false);
    audioEl.addEventListener('loadeddata', () => {
        log('loadeddata');
    }, false);
    audioEl.addEventListener('loadedmetadata', () => {
        log('loadedmetadata');
    }, false);
    // audioEl.addEventListener('canplay', () => {  // 重复播放  需要在标签加 loop
    //     log('canplay');
    // }, false);
    audioEl.addEventListener('play', () => {
        log('play');
        // 当 audio 能够播放后, 移除这个事件
        window.removeEventListener('touchstart', forceSafariPlayAudio, false);
    }, false);
    audioEl.addEventListener('playing', () => {
        log('playing');
    }, false);
    audioEl.addEventListener('pause', () => {
        log('pause');
    }, false);
    // 由于 iOS Safari 限制不允许 audio autoplay, 必须用户主动交互(例如 click)后才能播放 audio,
    // 因此我们通过一个用户交互事件来主动 play 一下 audio.
    window.addEventListener('touchstart', forceSafariPlayAudio, false);
    audioEl.src = 'img/kangkang.mp3.mp3';  //  在这里写上路径
}
</script>
